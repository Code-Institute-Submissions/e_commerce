{% extends 'base.html' %}

{% block content %}
<form method='GET' action=''>
    <input type='hidden submit' name='search-query' placeholder='Search products' value="{{ request.GET.q }}"/>
</form>

<label for="sort-select">Sort by </label>


<form method='GET' action=''>
    <label for="sort-select">Sort by </label>
    <select name="filter-query" id="sort-select" onchange="this.form.submit()">
        <option value="1">Newest to oldest</option>
        <option value="2">Oldest to Newest</option>
        <option value="3" selected>A-Z</option>
        <option value="4">Z-A</option>
        <option value="5">Price (high to low)</option>
        <option value="6">Price (low to high)</option>
    </select>
</form>


<form method='GET' action=''>
    <label for="brand-select">Filter by brand </label>
    <select name="brand-query" id="brand-select" onchange="this.form.submit()">
        {% for brand in brands %}
            <option value={{ brand.manufacturer|title }}>{{ brand.manufacturer|title }}</option>
        {% endfor %}
    </select>
</form>


    {% block products %}
    {% endblock %}

<div class="pagination">
    {% if products.has_previous %}
        <a class="pagination-action" href="?page=1{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">
            <i class="fa fa-angle-double-left"></i>
        </a>
        <a class="pagination-action" href="?page={{ products.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">
            <i class="fa fa-angle-left"></i>
        </a>
    {% endif %}
    {% for num in products.paginator.page_range %}
        {% if products.number == num %}
            <span class="pagination-number pagination-current" onclick="window.location.href='?page={{ num }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}'">{{ num }}</span>
        {% elif num > products.number|add:'-3' and num < products.number|add:'3' %}
            <span class="pagination-number" onclick="window.location.href='?page={{ num }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}'">{{ num }}</span>
        {% endif %} 
    {% endfor %}
    {% if products.has_next %}
        <a class="pagination-action" href="?page={{ products.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">
            <i class="fa fa-angle-right"></i>
        </a>
        <a class="pagination-action" href="?page={{ products.paginator.num_pages }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">
            <i class="fa fa-angle-double-right"></i>
        </a>
    {% endif %}
</div>

<h3>Featured Products</h3>

    {% for product in featured_products %}
    
        <div class="row">
            <div class="col-sm-10 col-md-9">
            {% if product.image %}
                <img src="{{ product.image }}">
            {% endif %}
            </div>
            <div class="col-md-10 col-sm-9">
                <h3>{{ product.name }}</h3>
                <p><a href="{% url 'product_details' product.id %}"  class="btn btn-default">Read more</a></p>
                
                <form method="POST" action="/products/add_to_cart">
                    {% csrf_token %}
                    <input type="hidden" name="product_id" value='{{product.id}}'/>
                    <button type="submit" class="btn btn-info">Add to Cart</button>
                </form>
                
                
                <div class="row">
                    <div class="col-xs-9">
                        <p><span class="boldtext"></span>{{ product.price }}</p>
                    </div>
                </div>
            </div>
            <hr>
        </div>
    {% endfor %}



{% endblock %}